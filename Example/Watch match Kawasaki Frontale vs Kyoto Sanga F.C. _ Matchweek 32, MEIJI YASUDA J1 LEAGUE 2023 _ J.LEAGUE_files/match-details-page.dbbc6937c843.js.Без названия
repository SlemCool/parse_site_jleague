const ticketsModal=function(){const t=".tickets-modal",n=".tickets-modal__backdrop",s=".tickets-modal__close",i=".tickets-list__body",e="tickets-modal--closed",a="noscroll"
let o=!1,l,r,c,d,u,m
const p=()=>{r.classList.add(e),l.classList.remove(a)},h=()=>{r.classList.remove(e),l.classList.add(a)}
return{init:function(e){if(o||(o=!0,l=document.querySelector("body"),r=document.querySelector(t),c=document.querySelector(i),r&&(d=r.querySelector(n),u=r.querySelector(s),d&&(d.onclick=p),u)&&(u.onclick=p)),m=e.startsWith("#")?document.querySelector(e):document.querySelectorAll(e))if(void 0===m.length)m.onclick=h
else for(const a of m)a.onclick=()=>{c.replaceChildren()
try{const s=JSON.parse(a.dataset.links)
Object.keys(s).forEach(e=>{var a=document.createElement("a"),t=document.createElement("span"),n=document.createTextNode(e)
t.classList.add("jl-button__label"),t.appendChild(n),a.appendChild(t),a.classList.add("jl-button","jl-button--inverse"),a.href=s[e],a.target="_blank",a.rel="nofollow noopener",c.appendChild(a)}),h()}catch(e){console.error(e)}}}}}()
let overviewLoadEventsInterval,overviewLoadVideoEventsInterval,overviewIsLoading=!1,overviewIsVideoLoading=!1,overviewIsDataLoaded=!1,matchGoalHighlights
function loadMatchEvents(){var e
if(!overviewIsLoading&&"overview"===currentTab)return overviewIsLoading=!0,e=`/match/data/${matchId}/events/`,ajaxRequest(e).then(e=>{var a
e&&0!==e.length?((a=$(".player-events")).html(e),a.removeClass("loading")):(clearInterval(overviewLoadEventsInterval),overviewLoadEventsInterval=null),overviewIsLoading=!1}).catch(e=>{console.error(e)})}function _checkVideoEventsVisibility(){isElementVisible(".video-events",function(){$(window).unbind("scroll")})}function initOverviewTab(){overviewIsDataLoaded||(overviewIsDataLoaded=!0,loadMatchEvents(),hasHighlight&&((matchGoalHighlights=new GoalHighlights(".video-events")).setMatch(matchId),matchGoalHighlights.loadVideos()),isLive&&(overviewLoadEventsInterval=setInterval(loadMatchEvents,6e4),overviewLoadVideoEventsInterval=setInterval(()=>{matchGoalHighlights.loadVideos(0,!0,!1)},3e5)),$(window).scroll(function(){_checkVideoEventsVisibility()}),_checkVideoEventsVisibility())}const lineupsHeaderContainer=$(".match-lineups__header"),lineupsBodyContainer=$(".match-lineups__body"),lineupsPlayersContainer=$(".lineup-players"),lineupsFormationsContainer=$(".lineup-formations"),lineupsAccordionClosedClassName="player-info--closed"
let lineupsPlayerMarkers,lineupsPlayerMarkerTooltip,lineupsFullname,lineupsPopperInstance,lineupsHasFormationData=!1,lineupsContentContainers,lineupsNavBar,lineupsNavBarEls,lineupsSlug="home",lineupsIsDataLoaded=!1
function _initLineups(){lineupsContentContainers=document.querySelectorAll(".lineup-detail"),lineupsNavBar=document.querySelector(".match-lineups__team-selector"),(lineupsNavBarEls=lineupsNavBar&&lineupsNavBar.querySelectorAll(".btn-nav"))&&lineupsNavBarEls.length&&lineupsNavBarEls.forEach(e=>{e.onclick=()=>{_setLineupsSlug(e.getAttribute("data-slug"))}}),window.addEventListener("resize",()=>{_updateLineupsStyle()}),_updateLineupsStyle()}function _setLineupsSlug(e){lineupsSlug=e,_updateLineupsStyle()}function _updateLineupsStyle(){var e=window.innerWidth
for(container of lineupsContentContainers){var a=container.querySelectorAll(".lineup-detail__team")
1080<=e?(lineupsNavBar&&lineupsNavBar.classList&&lineupsNavBar.classList.add("d-none"),a&&a.length&&(a[0].classList.remove("d-none"),a[1].classList.remove("d-none"))):(lineupsNavBar&&lineupsNavBar.classList&&lineupsNavBar.classList.remove("d-none"),lineupsNavBarEls&&lineupsNavBarEls.length&&lineupsNavBarEls.forEach(e=>{lineupsSlug===e.getAttribute("data-slug")?e.classList.add("active"):e.classList.remove("active")}),a&&a.length&&("home"===lineupsSlug?(a[0].classList.remove("d-none"),a[1].classList.add("d-none")):(a[0].classList.add("d-none"),a[1].classList.remove("d-none"))))}}function _loadMatchLineups(){var e=`/match/data/${matchId}/lineups/`
return ajaxRequest(e).then(e=>{lineupsPlayersContainer.empty(),e&&0!==e.trim().length&&lineupsPlayersContainer.html(e)})}function _loadMatchFormations(){var e=`/match/data/${matchId}/formations/`
return ajaxRequest(e).then(e=>{lineupsFormationsContainer.empty(),e&&0!==e.trim().length&&(lineupsFormationsContainer.html(e),lineupsHasFormationData=!0)})}function _onMouseEnterLineups(e){var a=$(this)
lineupsFullname=a.data("fullname"),team=a.data("team-slug")
lineupsPopperInstance=Popper.createPopper(a.get(0),lineupsPlayerMarkerTooltip.get(0),{placement:"bottom"}),lineupsPlayerMarkerTooltip.html(lineupsFullname),lineupsPlayerMarkerTooltip.addClass("team-bg--"+team),lineupsPlayerMarkerTooltip.addClass("team-text--"+team),lineupsPlayerMarkerTooltip.attr("data-show",""),lineupsPopperInstance.update()}function _onMouseLeaveLineups(e){lineupsPlayerMarkerTooltip.html(""),lineupsPlayerMarkerTooltip.removeClass("team-bg--"+team),lineupsPlayerMarkerTooltip.removeClass("team-text--"+team),lineupsPlayerMarkerTooltip.removeAttr("data-show"),lineupsPopperInstance&&(lineupsPopperInstance.destroy(),lineupsPopperInstance=null)}function _initLineupsTooltip(){lineupsPlayerMarkers=document.querySelectorAll(".player-marker:not(.player-marker--only-avatar"),lineupsPlayerMarkerTooltip=$(".player-marker-tooltip")
for(const e of lineupsPlayerMarkers)$(e).hover(_onMouseEnterLineups,_onMouseLeaveLineups)}function _onLineupsAccordionClick(e,a){e.hasClass(lineupsAccordionClosedClassName)||a.hasClass(lineupsAccordionClosedClassName)?(e.removeClass(lineupsAccordionClosedClassName),a.removeClass(lineupsAccordionClosedClassName)):(e.addClass(lineupsAccordionClosedClassName),a.addClass(lineupsAccordionClosedClassName))}function _initLineupsAccordion(e,a=!0){var t=e.find(".lineup-detail__team--home .player-info--home"),e=e.find(".lineup-detail__team--away .player-info--away"),n=t.find(".player-info__header"),s=e.find(".player-info__header")
a&&(t.addClass(lineupsAccordionClosedClassName),e.addClass(lineupsAccordionClosedClassName)),n.click(_onLineupsAccordionClick.bind(this,t,e)),s.click(_onLineupsAccordionClick.bind(this,t,e))}function initLineupsTab(){var e
lineupsIsDataLoaded||(lineupsIsDataLoaded=!0,lineupsBodyContainer.addClass("loading"),e=[_loadMatchLineups(),_loadMatchFormations()],Promise.all(e).then(()=>{var e=lineupsPlayersContainer.find(".lineup-detail--empty"),a=lineupsPlayersContainer.find(".lineup-detail--starting-xi")
e&&!e.length&&(lineupsHeaderContainer.removeClass("d-none"),_initLineupsAccordion(a),lineupsHasFormationData)&&(lineupsFormationsContainer.removeClass("d-none"),_initLineupsTooltip())}).finally(()=>{lineupsBodyContainer.removeClass("loading"),_initLineups()}).catch(e=>{console.error(e)}))}const statsBodyContainer=$(".match-stats__body")
let statsIsDataLoaded=!1,popperInstance
function _initStatCharts(){statsBodyContainer.find(".chart-item__chart").each(function(){var e=$(this),a=e.data("percent"),e=e.find(".chart-item__chart__overlay")
e&&e.css("width",a+"%")})}function initStatsTab(){var e
statsIsDataLoaded||(statsIsDataLoaded=!0,e=`/match/data/${matchId}/stats/`,statsBodyContainer.addClass("loading"),ajaxRequest(e).then(e=>{statsBodyContainer.empty(),e&&0!==e.trim().length&&statsBodyContainer.html(e),statsBodyContainer.removeClass("loading"),clubPlayerStat.init(),setTimeout(()=>_initStatCharts(),500)}).catch(e=>{console.error(e)}))}const clubPlayerStat=function(){let a,t,e=!1,n=!1
function s(){$(".ranking-columns .rank").each(function(){const t=$(this),n=t.find(".tooltiptext")
t.on("mouseenter",()=>{return e=t,a=n,popperInstance=Popper.createPopper(e.get(0),a.get(0),{placement:"top"}),a.removeClass("d-none"),void popperInstance.update()
var e,a}).on("mouseleave",()=>{return t,n,n.addClass("d-none"),void(popperInstance&&(popperInstance.destroy(),popperInstance=null))})})}function i(){a.addClass("loading"),t.attr("disabled",!0)
var e=t.val(),e=`/match/data/${matchId}/players/stats/${e}/`
return ajaxRequest(e).then(e=>{a.empty(),""!==e.trim()&&a.html(e),a.removeClass("loading"),t.removeAttr("disabled"),s()}).catch(e=>{console.error(e)})}return{init:function(){a=$(".player-stats .ranking-boards"),(t=$(".player-stat-selector")).change(i),$(window).scroll(function(){e||!isScrolledIntoView(".player-stats")||n||(n=!0,i().then(()=>{e=!0}))})}}}(),standingsBodyContainer=$(".match-standings__body")
let standingsIsDataLoaded=!1
function initStandingsTab(){var e
standingsIsDataLoaded||(standingsIsDataLoaded=!0,e=`/match/data/${matchId}/standings/`,standingsBodyContainer.addClass("loading"),ajaxRequest(e).then(e=>{standingsBodyContainer.empty(),e&&0!==e.trim().length&&standingsBodyContainer.html(e),standingsBodyContainer.removeClass("loading")}).catch(e=>{console.error(e)}))}const headerContainer=$(".match-details-header"),matchLineups=$(".match-lineups"),matchOverview=$(".match-overview"),matchStandings=$(".match-standings"),matchStats=$(".match-stats"),matchTabbarItem=$(".match-tabbar__item")
let currentTab,viewLive
const summaryResultContainer=$(".match-details-header__summary")
let summaryLoadInterval,summaryIsLoading=!1
function _initTab(){matchTabbarItem.on("click",function(){var e=$(this),a=e.data("datatype")
_onTabSelect(e,a)}),_checkHashFromURL()}function _onTabSelect(e,a){window.location.hash="#"+a,matchTabbarItem.removeClass("active"),e.addClass("active"),_changeTab(a)}function _changeTab(e){switch(matchLineups.addClass("d-none"),matchOverview.addClass("d-none"),matchStandings.addClass("d-none"),matchStats.addClass("d-none"),currentTab=e){case"overview":matchOverview.removeClass("d-none"),initOverviewTab()
break
case"lineups":matchLineups.removeClass("d-none"),initLineupsTab()
break
case"stats":matchStats.removeClass("d-none"),initStatsTab()
break
case"table":matchStandings.removeClass("d-none"),initStandingsTab()}sendSelectContentEvent("match_"+e,competitionSlug+"_"+matchId)}function _checkHashFromURL(){const t=location.hash?location.hash.replace("#",""):""
viewLive="live"===t,matchTabbarItem.each(function(){var e=$(this),a=e.data("datatype")
t!==a&&("overview"!==a||""!==t&&"live"!==t)||_onTabSelect(e,a)})}function _loadMatchSummary(){var e
if(!summaryIsLoading)return summaryIsLoading=!0,e=`/match/data/${matchId}/summary/`,ajaxRequest(e).then(e=>{e&&0!==e.length?summaryResultContainer.html(e):(clearInterval(summaryLoadInterval),summaryLoadInterval=null),summaryIsLoading=!1}).catch(e=>{console.error(e)})}function _initMatchSummary(){"True"===isLive&&setTimeout(()=>{summaryLoadInterval=setInterval(_loadMatchSummary,6e4),_loadMatchSummary()},remainSeconds),_loadMatchSummary()}function _initMatchLive(){var e=`/match/data/${matchId}/live/`
return ajaxRequest(e).then(e=>{e&&0!==e.trim().length&&(headerContainer.append(e),viewLive)&&setTimeout(()=>{var e=headerContainer.find("#live")[0]
e&&e.scrollIntoView()},500)}).catch(e=>{console.error(e)})}$(document).ready(function(){_initTab(),_initMatchLive(),_initMatchSummary(),1<totalTickets&&ticketsModal.init("#tickets-modal-trigger"),"undefined"!=typeof sidebar&&["j1","j2","j3"].includes(competitionSlug)&&(localStorage.setItem("sidebar.competition",competitionSlug),localStorage.setItem("sidebar.tab","matches"),localStorage.setItem("sidebar.matchweek",occasionNo),localStorage.getItem("sidebar.expanded"))&&setTimeout(()=>sidebar.refresh(!0),1e3)})